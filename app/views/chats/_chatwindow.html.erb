<div class="card card-cascade">
  <div class="view view-cascade gradient-card-header blue-gradient p-2">

    <div class="row">
        <div class="col-md-3">
            <h2 class="card-header-title mb-0 text-left ml-3 align-items-center mt-1">Chat</h2>
        </div>
        <div class="col-md-9 text-right">
          <% if current_user.id==@chat.admin_id %>
            <%= link_to destroyall_messages_path(chat_room: @chat.id), method: :delete, class: 'btn btn-warning btn-sm' do %>
              Clear
            <% end %>

            <%= link_to chat_path(@chat), method: :delete, class: 'btn btn-danger btn-sm' do %>
                Delete
            <% end %>

          <% else %>
            <%= link_to delete_user_chat_path(user_id: current_user.id, id: @chat.id), method: :delete, class: 'btn btn-danger btn-sm' do %>
                Quit
            <% end %>
          <% end %>

        </div>
    </div>

  </div>

  <div class="card-body card-body-cascade">
    <div class="card-text custom-scrollbar scrollbar-near-moon" style="max-height: 600px">

        <div id="demo-chat-body">
          <div class="nano has-scrollbar custom-scrollbar scrollbar-near-moon" style="height:600px">
            <div class="nano-content pad-all" tabindex="0" style="right: -17px;">
              <ul class="list-unstyled media-block">

                <%= sync partial: 'message_row', collection: Message.by_chat(@chat), refetch: true %>
                <%= sync_new partial: 'message_row', resource: Message.new, scope: @chat, refetch: true %>

              </ul>
            </div>
            <div class="nano-pane">
              <div class="nano-slider" style="height: 141px; transform: translate(0px, 0px);"></div>
            </div>
          </div>
        </div>

    </div>

    <hr>

        <%= form_for @new_message, remote: true do |f| %>
    <div class="md-form input-group">
      <%= f.text_field :body, class: "form-control", placeholder: "Type your message here..." %>
      <div class="input-group-append">
        <%= f.submit "Send", class: "btn btn-md btn-secondary m-0 px-3" %>
        <!-- <button class="btn btn-md btn-secondary m-0 px-3" type="button" id="MaterialButton-addon2">Send</button> -->
      </div>
      <%= hidden_field_tag :chat_room, @chat.id %>
    </div>

        <% end %>
  </div>

</div>


<script>
    var $cont = $('.nano-content');
    $cont[0].scrollTop = $cont[0].scrollHeight;
</script>

