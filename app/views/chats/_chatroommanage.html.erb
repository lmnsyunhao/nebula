<div class="card" style="height: 709px;">
  <div class="card-body">
    <h4 class="card-title">
      <div class="row">
        <div class="col-md-3 pt-2"><a>房间信息</a></div>
        <div class="col-md-9 text-right">

        <% if current_user.id==@chat.admin_id %>

        <button type="button" class="btn btn-success btn-sm" data-toggle="modal" data-target="#chatroomadduser">
          add
        </button>
        <div class="modal fade" id="chatroomadduser" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">加入用户</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>

              <%= form_for @chat, url: add_user_chat_path(@chat), method: :post, role: 'form' do |f| %>
              <div class="modal-body">

                <%= select_tag :users, options_for_select(@friends_out_chat.map { |user| [user.name, user.id] }), class: "mdb-select md-form colorful-select dropdown-default", multiple: "multiple", multiple: true, style: "width: 100%" %>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <%= f.submit '确定', class: 'btn btn-primary btn-sm' %>
              </div>
              <% end %>

            </div>
          </div>
        </div>

        <button type="button" class="btn btn-warning btn-sm" data-toggle="modal" data-target="#transroomadmin">
          trans
        </button>
        <div class="modal fade" id="transroomadmin" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">移交管理权限</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <%= form_for @chat, url: trans_auth_chat_path(@chat), method: :patch, role: 'form' do |f| %>
              <div class="modal-body">
                <%= select_tag :admin_id, options_for_select(@users_in_chat.map { |user| [user.name, user.id] }), class: "mdb-select md-form colorful-select dropdown-danger", style: "width: 100%" %>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <%= f.submit '确定', class: 'btn btn-primary btn-sm' %>
              </div>
              <% end %>

            </div>
          </div>
        </div>

        <button type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#editroomname">
          edit
        </button>
        <div class="modal fade" id="editroomname" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">编辑房间名</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <%= form_for @chat, url: chat_path(@chat), method: :patch, role: "form" do |f| %>
              <div class="modal-body">

                <div class="md-form">
                  <%= f.text_field :name, class: "form-control" %>
                  <label for="name">Example label</label>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <%= f.submit '确定', class: 'btn btn-primary btn-sm' %>
              </div>
              <% end %>

            </div>
          </div>
        </div>

        <% end %>

          <%= link_to delete_user_chat_path(user_id: current_user.id, id: @chat.id), method: :delete, class: 'btn btn-danger btn-sm m-0' do %>
              quit
          <% end %>
        </div>
      </div>
    </h4>
    <hr>
    <p class="card-text">
      房间名: <%= @chat.name %>
    </p>
    <hr>
    <p class="card-text">
    当前用户:<br>
    <div class="row custom-scrollbar scrollbar-near-moon" style="height: 240px; max-height: 240px; overflow-y: auto;">
    <% @chat.users.each do |user| %>
      <div class="col-md-2">
        <div class="card card-cascade">
          <div class="view view-cascade overlay">
            <%= image_tag "user-icon.png", class: "card-img-top", alt: "normal" %>
            <a><div class="mask rgba-white-slight"></div></a>
          </div>
          <div class="card-body card-body-cascade text-center p-0 pt-2">
            <%= truncate(user.name,length: 6) %>
            <% if current_user.id==@chat.admin_id %>
            <%= link_to delete_user_chat_path(user_id: user.id, id: @chat.id), method: :delete, class: 'm-0 mb-2', style:'color:red;' do %>
            <i class="fa fa-remove"></i>
            <% end %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
    </div>
    </p>
    <hr>
    <p class="card-text">
      online:<br>
      <div class="row custom-scrollbar scrollbar-near-moon" style="height: 200px; max-height: 200px; overflow-y: auto;">
      </div>
    </p>
  </div>
</div>

<script type="text/javascript">

    // $(".js-example-basic-multiple").select2();
    // $(".js-example-basic-single").select2();

</script>